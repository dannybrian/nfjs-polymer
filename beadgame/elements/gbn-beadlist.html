<link rel="import" href="/elements/polymer.html">
<link rel="import" href="/elements/gbn-bead.html">

<polymer-element name="gbn-beadlist" >
    <template>
        <div id="beadlist" class="bead-list">
            <template repeat="{{bead in beads}}">
                <gbn-bead id="{{id}}" img="{{bead.img}}" name="{{bead.name}}" removing="false"></gbn-bead>
            </template>
        </div>
    </template>
    
    <script>
        Polymer(Polymer.mixin({
          shadowBeads: [],
          beads: [],
          observe: {
            shadowBeads: function(event, change) {
                if (event.length > 0) {
                    if (event[0].addedCount > 0) {
                        this.beads.push(this.shadowBeads[event[0].index]);
                    }
                    else if (event[0].removed.length > 0) {
                        this.fire('hideBead', { name: this.beads[event[0].index].name });
                        this.job('hiding', function() {
                            this.beads.splice(event[0].index, 1);
                        }, 500);
                    }
                }
                this.resetGraph();
            },
          },
          ready: function() {
            this.addEventListener('bead-pan', function (e) { this.resetGraph(); });
            this.addEventListener('bead-removed', function(e) { this.resetGraph(); });
            this.addEventListener('bead-touch', function (e) { 
                var ztops = document.querySelectorAll('.ztop')
                for (var i = 0; i < ztops.length; i++) {
                    ztops[i].classList.remove('ztop');
                }
            });
            this.shadowBeads = [
                { img: 'Doing Good-15.svg', name: 'ecology' },
                { img: 'Ecology-02.svg', name: 'leaf' },
                { img: 'Education_Science-19.svg', name: 'education' },
                { img: 'Vacation Spots-21.svg', name: 'ice vacation' },
                { img: 'Ecommerce Set-22.svg', name: 'ecommerce' },
                { img: 'ff0c3f29-8587-42b0-8088-4277f87bb47a.svg', name: 'Compton High School' }
            ];
            for (var i = 0; i < this.shadowBeads.length; i++) {
                this.beads.push(this.shadowBeads[i]);
            }
            
            this.setCount(6);
            this.setArea();
            this.moveBeads();
          }
        },
        window.mixins.forcegraph));
    </script>
    
</polymer-element>