<link rel="import" href="/elements/polymer.html">

<polymer-element name="gbn-bead" attributes="img name bead">
    <template>
        <link rel="stylesheet" href="../css/gbn-bead.css"/>
        <div id="bead" class="bead-cont">
            <div class="label-cont">
                <div class="label">{{name}}</div>
            </div>
            <img id="image" src="/beads/svg/{{img}}"/>
            <div class="timer-top"></div>
            <div class="timer-bot"></div>
        </div>
    </template>
    
    <script>
        Polymer(Polymer.mixin({
          edges: [],
          repulse: 0.4,
          panning: false,
          show: function() {
              this.addClass('shown');
          },
          hide: function() {
              this.removeClass('shown');
              this.ignore = true; // so that the graph will not use it
          },
          remove: function() {
              var self = this;
              this.hide();
              this.fire('bead-removed', {});
              this.job('removeself', function() {
                  self.parentNode.removeChild(self);
              }, 500);
          },
          tap: function () {
              this.remove();
              // this.$.bead.classList.toggle('flipped');
          },
          ready: function() {
            var self = this;
            document.addEventListener('hideBead', function(e) {
                if (e.detail.name === self.name) {
                    self.hide();
                }
            });
            this.$.image.addEventListener('load', function() {
                self.show();
            });
            this.draginit();
            this.x = window.innerWidth / 2 + ((Math.random() * 200) - 100);
            this.y = window.innerHeight / 2 + ((Math.random() * 200 - 100));
            this.commitPos();
          },
        },
        window.mixins.manip, window.mixins.movable, window.mixins.draggable));
    </script>
    
</polymer-element>